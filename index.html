<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>草莓冒险 🍓</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ERJQSXTBGE"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ERJQSXTBGE');
        
        // Track page views
        gtag('event', 'page_view', {
            page_title: '草莓冒险 - 主页',
            page_location: window.location.href
        });
        
        // Track all click events
        document.addEventListener('DOMContentLoaded', function() {
            // Track button clicks
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    gtag('event', 'button_click', {
                        button_text: this.textContent,
                        button_id: this.id,
                        page_title: '草莓冒险 - 主页'
                    });
                });
            });
            
            // Track link clicks
            const links = document.querySelectorAll('a');
            links.forEach(link => {
                link.addEventListener('click', function() {
                    gtag('event', 'link_click', {
                        link_text: this.textContent,
                        link_href: this.href,
                        page_title: '草莓冒险 - 主页'
                    });
                });
            });
        });
        
        // Track scroll events
        let scrollTracked = false;
        window.addEventListener('scroll', function() {
            const scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);
            
            // Track when user scrolls to bottom (90% or more)
            if (scrollPercent >= 90 && !scrollTracked) {
                scrollTracked = true;
                gtag('event', 'scroll_to_bottom', {
                    page_title: '草莓冒险 - 主页',
                    scroll_percent: scrollPercent
                });
            }
            
            // Track scroll milestones (25%, 50%, 75%)
            if (scrollPercent >= 25 && scrollPercent < 26) {
                gtag('event', 'scroll_milestone', {
                    page_title: '草莓冒险 - 主页',
                    milestone: '25%'
                });
            } else if (scrollPercent >= 50 && scrollPercent < 51) {
                gtag('event', 'scroll_milestone', {
                    page_title: '草莓冒险 - 主页',
                    milestone: '50%'
                });
            } else if (scrollPercent >= 75 && scrollPercent < 76) {
                gtag('event', 'scroll_milestone', {
                    page_title: '草莓冒险 - 主页',
                    milestone: '75%'
                });
            }
        });
    </script>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas" width="1280" height="720"></canvas>
        
        <!-- Mobile Touch Controls -->
        <div id="mobileControls" class="mobile-controls">
            <button id="leftBtn" class="control-btn">←</button>
            <button id="rightBtn" class="control-btn">→</button>
            <button id="jumpBtn" class="control-btn">↑</button>
        </div>
        
        <!-- HUD -->
        <div id="hud" class="hud">
            <div class="hud-item">关卡: <span id="levelDisplay">1</span></div>
            <div class="hud-item">分数: <span id="scoreDisplay">0</span></div>
            <div class="hud-item">生命: <span id="livesDisplay">3</span></div>
            <div class="hud-item">时间: <span id="timeDisplay">--</span></div>
        </div>
        
        <!-- Game States -->
        <div id="menuScreen" class="game-screen">
            <h1>🍓 草莓冒险 🍓</h1>
            <p>帮助小女孩收集草莓并到达旗帜！</p>
            <button id="startBtn" class="game-btn">开始冒险！</button>
            <button id="muteBtn" class="game-btn">🔊 声音: 开</button>
        </div>
        
        <div id="pauseScreen" class="game-screen hidden">
            <h2>游戏暂停</h2>
            <button id="resumeBtn" class="game-btn">继续</button>
            <button id="menuBtn" class="game-btn">返回菜单</button>
        </div>
        
        <div id="levelCompleteScreen" class="game-screen hidden">
            <h2>🎉 太棒了！🎉</h2>
            <p>关卡完成！</p>
            <div id="confetti"></div>
            <button id="nextLevelBtn" class="game-btn">下一关</button>
            <button id="menuBtn2" class="game-btn">返回菜单</button>
        </div>
        
        <div id="gameOverScreen" class="game-screen hidden">
            <h2>试试不同的路线！</h2>
            <p>不要放弃！你能做到的！</p>
            <button id="retryBtn" class="game-btn">再试一次</button>
            <button id="menuBtn3" class="game-btn">返回菜单</button>
        </div>
        
        <div id="allClearScreen" class="game-screen hidden">
            <h2>🎊 恭喜！🎊</h2>
            <p>你完成了草莓冒险！</p>
            <p>你是一个真正的冒险家！</p>
            <div id="finalConfetti"></div>
            <button id="playAgainBtn" class="game-btn">再玩一次</button>
        </div>
    </div>
    
    <script type="module" src="game.js"></script>
</body>
</html> 